[2025-02-22 18:07:00,437] INFO [QuorumController id=1] Creating new QuorumController with clusterId F5Tf89hnT_KeW-EudBeTUw. (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:07:00,438] INFO [QuorumController id=1] Starting to load snapshot 00000000000000000000-0000000000. Previous lastCommittedOffset was -1. Previous transactionStartOffset was -1. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:07:00,438] INFO [QuorumController id=1] Successfully loaded snapshot 00000000000000000000-0000000000. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:07:00,438] INFO [QuorumController id=1] Becoming the active controller at epoch 1, next write offset 3. (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:07:00,440] WARN [QuorumController id=1] Performing controller activation. The metadata log appears to be empty. Appending 1 bootstrap record(s) in metadata transaction at metadata.version 3.9-IV0 from bootstrap source 'the binary bootstrap metadata file: /tmp/kraft-combined-logs/bootstrap.checkpoint'. Setting the ZK migration state to NONE since this is a de-novo KRaft cluster. (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:07:00,441] INFO [QuorumController id=1] Replayed BeginTransactionRecord(name='Bootstrap records') at offset 3. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:07:00,442] INFO [QuorumController id=1] Replayed a FeatureLevelRecord setting metadata.version to 3.9-IV0 (org.apache.kafka.controller.FeatureControlManager)
[2025-02-22 18:07:00,442] INFO [QuorumController id=1] Replayed EndTransactionRecord() at offset 6. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:07:00,510] INFO [QuorumController id=1] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1, incarnationId=ZL5Yrd13QpSsmVavsjmbXg, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=9093)], supportedFeatures={kraft.version: 0-1, metadata.version: 1-21}). (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:07:00,552] INFO [QuorumController id=1] No previous registration found for broker 1. New incarnation ID is p8pvTMbxQSOT8j3wnqe4Bg.  Generated 0 record(s) to clean up previous incarnations. New broker epoch is 8. (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:07:00,553] INFO [QuorumController id=1] Replayed initial RegisterBrokerRecord for broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=p8pvTMbxQSOT8j3wnqe4Bg, brokerEpoch=8, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=21)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[G0VGp9yLSqCDJ3lnFLTv0Q]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:07:00,622] INFO [QuorumController id=1] The request from broker 1 to unfence has been granted because it has caught up with the offset of its register broker record 8. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-22 18:07:00,625] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=8, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:14:49,984] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:14:50,001] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-02-22 18:14:50,003] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-02-22 18:14:50,026] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-02-22 18:14:50,028] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-02-22 18:14:50,029] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-02-22 18:14:50,030] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-02-22 18:14:50,036] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-02-22 18:14:50,038] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:14:50,042] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-02-22 18:14:50,044] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-02-22 18:14:50,045] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:14:50,045] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:14:50,045] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:14:50,045] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-02-22 18:14:50,047] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-02-22 18:14:50,047] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:14:50,047] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-02-22 18:14:50,047] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-02-22 18:14:50,048] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-02-22 18:14:50,052] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:14:50,052] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:14:50,053] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:14:50,053] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:14:50,053] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:14:50,053] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:14:50,054] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:14:50,055] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-02-22 18:14:50,055] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-02-22 18:14:50,058] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:14:50,061] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:14:50,061] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:14:50,061] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-02-22 18:14:50,067] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-02-22 18:14:50,086] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-02-22 18:14:50,091] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=1, kraftController=false, type=UNKNOWN, brokerEpoch=25, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='localhost', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker localhost:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:14:50,140] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:14:50,141] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:14:50,141] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:14:50,141] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-02-22 18:14:50,141] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:14:50,141] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:14:50,142] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:14:50,142] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-02-22 18:14:50,142] ERROR [RequestSendThread controllerId=0] Controller 0 fails to send a request to broker localhost:9092 (id: 0 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:14:50,142] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-02-22 18:14:50,142] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-02-22 18:14:50,143] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-02-22 18:15:04,588] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:15:04,600] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-02-22 18:15:04,601] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-02-22 18:15:04,602] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-02-22 18:15:04,603] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-02-22 18:15:04,604] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-02-22 18:15:04,612] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 46) (kafka.controller.KafkaController)
[2025-02-22 18:15:04,614] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:15:04,617] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-02-22 18:15:04,619] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-02-22 18:15:04,619] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:15:04,619] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:15:04,620] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:15:04,620] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-02-22 18:15:04,621] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-02-22 18:15:04,621] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:15:04,621] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-02-22 18:15:04,621] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-02-22 18:15:04,622] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-02-22 18:15:04,626] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:15:04,626] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:15:04,627] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:15:04,627] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:15:04,627] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:15:04,628] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:15:04,628] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:15:04,628] INFO [Controller id=0] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-02-22 18:15:04,629] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-02-22 18:15:04,631] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:15:04,631] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:15:04,631] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:15:04,631] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-02-22 18:15:04,631] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-02-22 18:15:04,640] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-02-22 18:15:04,653] WARN [RequestSendThread controllerId=0] Controller 0 epoch 2 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=2, kraftController=false, type=UNKNOWN, brokerEpoch=46, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='localhost', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker localhost:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:15:04,713] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:15:04,713] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:15:04,713] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:15:04,713] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-02-22 18:15:04,714] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:15:04,714] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:15:04,714] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:15:04,714] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-02-22 18:15:04,715] ERROR [RequestSendThread controllerId=0] Controller 0 fails to send a request to broker localhost:9092 (id: 0 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:15:04,715] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-02-22 18:15:04,715] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-02-22 18:15:04,715] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-02-22 18:19:39,282] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:19:39,295] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2025-02-22 18:19:39,296] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-02-22 18:19:39,297] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-02-22 18:19:39,298] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-02-22 18:19:39,299] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-02-22 18:19:39,308] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 65) (kafka.controller.KafkaController)
[2025-02-22 18:19:39,310] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:19:39,312] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-02-22 18:19:39,315] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-02-22 18:19:39,316] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:19:39,316] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:19:39,316] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:19:39,316] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-02-22 18:19:39,318] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-02-22 18:19:39,318] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:19:39,318] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-02-22 18:19:39,318] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-02-22 18:19:39,318] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-02-22 18:19:39,323] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:19:39,323] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:19:39,325] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:19:39,325] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:19:39,325] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:19:39,325] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:19:39,326] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9091 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-02-22 18:19:39,326] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:19:39,327] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2025-02-22 18:19:39,329] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:19:39,329] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:19:39,329] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:19:39,329] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-02-22 18:19:39,330] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-02-22 18:19:39,337] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-02-22 18:19:39,366] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=3, kraftController=false, type=UNKNOWN, brokerEpoch=65, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9091, host='localhost', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker localhost:9091 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:19:39,416] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:19:39,416] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:19:39,416] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:19:39,416] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-02-22 18:19:39,417] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:19:39,417] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:19:39,417] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:19:39,417] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-02-22 18:19:39,417] ERROR [RequestSendThread controllerId=0] Controller 0 fails to send a request to broker localhost:9091 (id: 0 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:19:39,417] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-02-22 18:19:39,417] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-02-22 18:19:39,418] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-02-22 18:20:45,308] INFO [QuorumController id=1] Unfenced broker 1 has requested and been granted an immediate shutdown. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-22 18:20:45,309] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=8, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:20:45,526] INFO [QuorumController id=1] writeNoOpRecord: event unable to start processing because of RejectedExecutionException (treated as TimeoutException). Exception message: The event queue is shutting down (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:21:05,560] INFO [QuorumController id=1] Creating new QuorumController with clusterId F5Tf89hnT_KeW-EudBeTUw. (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:21:05,561] INFO [QuorumController id=1] Starting to load snapshot 00000000000000000000-0000000000. Previous lastCommittedOffset was -1. Previous transactionStartOffset was -1. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:21:05,562] INFO [QuorumController id=1] Successfully loaded snapshot 00000000000000000000-0000000000. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:21:05,562] INFO [QuorumController id=1] Replayed BeginTransactionRecord(name='Bootstrap records') at offset 3. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:21:05,562] INFO [QuorumController id=1] Replayed a FeatureLevelRecord setting metadata.version to 3.9-IV0 (org.apache.kafka.controller.FeatureControlManager)
[2025-02-22 18:21:05,562] INFO [QuorumController id=1] Replayed EndTransactionRecord() at offset 6. (org.apache.kafka.controller.OffsetControlManager)
[2025-02-22 18:21:05,563] INFO [QuorumController id=1] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1, incarnationId=ZL5Yrd13QpSsmVavsjmbXg, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=9093)], supportedFeatures={kraft.version: 0-1, metadata.version: 1-21}). (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,564] INFO [QuorumController id=1] Replayed initial RegisterBrokerRecord for broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=p8pvTMbxQSOT8j3wnqe4Bg, brokerEpoch=8, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=21)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[G0VGp9yLSqCDJ3lnFLTv0Q]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,564] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=8, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,575] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=8, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,576] INFO [QuorumController id=1] Becoming the active controller at epoch 2, next write offset 1651. (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:21:05,577] WARN [QuorumController id=1] Performing controller activation. Loaded ZK migration state of NONE. This is expected because this is a de-novo KRaft cluster. (org.apache.kafka.controller.QuorumController)
[2025-02-22 18:21:05,628] INFO [QuorumController id=1] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1, incarnationId=WFQVVRO7QliVnCDNX8L32Q, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=9093)], supportedFeatures={kraft.version: 0-1, metadata.version: 1-21}). Previous incarnation was ZL5Yrd13QpSsmVavsjmbXg (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,692] INFO [QuorumController id=1] Registering a new incarnation of broker 1. Previous incarnation ID was p8pvTMbxQSOT8j3wnqe4Bg; new incarnation ID is Fe_0sC2zTMyzy79sNCzJyg. Generated 0 record(s) to clean up previous incarnations. Broker epoch will become 1652. (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,693] INFO [QuorumController id=1] Replayed RegisterBrokerRecord establishing a new incarnation of broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=Fe_0sC2zTMyzy79sNCzJyg, brokerEpoch=1652, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=21)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[G0VGp9yLSqCDJ3lnFLTv0Q]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:21:05,762] INFO [QuorumController id=1] The request from broker 1 to unfence has been granted because it has caught up with the offset of its register broker record 1652. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-22 18:21:05,763] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=1652, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-22 18:25:02,509] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-02-22 18:25:02,521] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2025-02-22 18:25:02,522] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-02-22 18:25:02,523] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-02-22 18:25:02,524] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-02-22 18:25:02,525] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-02-22 18:25:02,534] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 84) (kafka.controller.KafkaController)
[2025-02-22 18:25:02,536] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:25:02,538] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-02-22 18:25:02,540] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-02-22 18:25:02,540] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-02-22 18:25:02,541] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:25:02,541] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-02-22 18:25:02,541] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-02-22 18:25:02,542] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-02-22 18:25:02,542] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:25:02,542] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-02-22 18:25:02,542] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-02-22 18:25:02,543] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-02-22 18:25:02,547] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:25:02,547] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:25:02,548] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:25:02,548] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-02-22 18:25:02,548] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:25:02,549] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:25:02,549] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-02-22 18:25:02,549] INFO [Controller id=0] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2025-02-22 18:25:02,553] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker localhost:9091 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9091 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-02-22 18:25:02,553] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:25:02,554] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-02-22 18:25:02,554] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-02-22 18:25:02,554] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-02-22 18:25:02,554] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-02-22 18:25:02,562] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-02-22 18:25:02,658] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9091 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-02-22 18:25:07,568] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-02-22 18:25:07,569] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-02-22 18:30:07,559] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-02-22 18:30:07,561] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-02-22 18:35:07,551] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-02-22 18:35:07,553] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
